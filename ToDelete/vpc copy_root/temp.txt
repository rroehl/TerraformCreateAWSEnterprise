
/*
resource "null_resource" "subnet_resource_id" {
  
    depends_on = [aws_subnet.create_subnets] 

    provisioner "local-exec" {
        command = "aws replace-network-acl-association --association-id ${<value>} --network-acl-id ${<value>}}"
  }

}
*/


    
    RegionMap = {

        us-west-2 = { # Region
		    
			vpc_info = {
				ProdVPC = {   # VPC
					vpc_cidr_block = "10.51.0.0/16"
					vpc_environment_type = "Prod"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false*/
	
					az_info = {

						us-west-2a = { # Availbility Zone
							Public = [
								"10.51.0.0/24","10.51.1.0/24","10.51.2.0/24","10.51.3.0/24"
								]
							Private = [
								"10.51.4.0/24","10.51.5.0/24",  "10.51.6.0/24","10.51.7.0/24", "10.51.8.0/24"
								]
							Network = [
								"10.51.60.0/24","10.51.61.0/24","10.51.62.0/24","10.51.63.0/24"
								]
						},
						us-west-2b = {  # Availbility Zone
							Public = [
								"10.51.64.0/24","10.51.65.0/24","10.51.66.0/24","10.51.67.0/24" 
								]
							Private = [
								"10.51.68.0/24","10.51.69.0/24","10.51.70.0/24","10.51.71.0/24","10.51.72.0/24"
								]
							Network = [
								"10.51.124.0/24","10.51.125.0/24","10.51.126.0/24","10.51.127.0/24"
								]
						},
						us-west-2c = {  # Availbility Zone
							Public = [
								"10.51.128.0/24","10.51.129.0/24","10.51.130.0/24","10.51.131.0/24"
								]
							Private = [
								"10.51.132.0/24","10.51.133.0/24","10.51.134.0/24","10.51.135.0/24"
								]
							Network = [
								"10.51.189.0/24","10.51.190.0/24","10.51.191.0/24"
								]
						}
					}
				},
				TestVPC = {  # VPC
					vpc_cidr_block = "10.52.0.0/16"
					vpc_environment_type ="Test"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false	
					vpc_enable_classiclink = false */
					
					az_info = {

						us-west-2a = {  # Availbility Zone
							Public = [
								"10.52.0.0/24","10.52.1.0/24","10.52.2.0/24","10.52.3.0/24"
								]
							Private = [
								"10.52.4.0/24","10.52.5.0/24",  "10.52.6.0/24","10.52.7.0/24", "10.52.8.0/24"
								]
							Network = [
								"10.52.60.0/24","10.52.61.0/24","10.52.62.0/24","10.52.63.0/24"
								]
						},
						us-west-2b = {  # Availbility Zone
							Public = [
								"10.52.64.0/24","10.52.65.0/24","10.52.66.0/24","10.52.67.0/24" 
								]
							Private = [
								"10.52.68.0/24","10.52.69.0/24","10.52.70.0/24","10.52.71.0/24","10.52.72.0/24"
								]
							Network = [
								"10.52.124.0/24","10.52.125.0/24","10.52.126.0/24","10.52.127.0/24"
								]
						},
						us-west-2c = {  # Availbility Zone
							Public = [
								"10.52.128.0/24","10.52.129.0/24","10.52.130.0/24","10.52.131.0/24"
								]
							Private = [
								"10.52.132.0/24","10.52.133.0/24","10.52.134.0/24","10.52.135.0/24"
								]
							Network = [
								"10.52.189.0/24","10.52.190.0/24","10.52.191.0/24"
								]
						}

					}
				},
				DevVPC = {   # VPC
					vpc_cidr_block = "10.53.0.0/16"
					vpc_environment_type = "Dev"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-west-2a = {   # Availbility Zone
							Public = [
								"10.53.0.0/24","10.53.1.0/24","10.53.2.0/24","10.53.3.0/24"
								]
							Private = [
								"10.53.4.0/24","10.53.5.0/24",  "10.53.6.0/24","10.53.7.0/24", "10.53.8.0/24"
								]
							Network = [
								"10.53.60.0/24","10.53.61.0/24","10.53.62.0/24","10.53.63.0/24"
								]
						},
						us-west-2b = {   # Availbility Zone
							Public = [
								"10.53.64.0/24","10.53.65.0/24","10.53.66.0/24","10.53.67.0/24" 
								]
							Private = [
								"10.53.68.0/24","10.53.69.0/24","10.53.70.0/24","10.53.71.0/24","10.53.72.0/24"
								]
							Network = [
								"10.53.124.0/24","10.53.125.0/24","10.53.126.0/24","10.53.127.0/24"
								]
						},
						us-west-2c = {  # Availbility Zone
							Public = [
								"10.53.128.0/24","10.53.129.0/24","10.53.130.0/24","10.53.131.0/24"
								]
							Private = [
								"10.53.132.0/24","10.53.133.0/24","10.53.134.0/24","10.53.135.0/24"
								]
							Network = [
								"10.53.189.0/24","10.53.190.0/24","10.53.191.0/24"
								]
						}

					}
				},

                SharedServiceVPC = {   # VPC
					vpc_cidr_block = "10.54.0.0/16"
					vpc_environment_type = "Prod"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-west-2a = {   # Availbility Zone
							Public = [
								"10.54.0.0/24","10.54.1.0/24","10.54.2.0/24","10.54.3.0/24"
								]
							Private = [
								"10.54.4.0/24","10.54.5.0/24",  "10.54.6.0/24","10.54.7.0/24", "10.54.8.0/24"
								]
							Network = [
								"10.54.60.0/24","10.54.61.0/24","10.54.62.0/24","10.54.63.0/24"
								]
						},
						us-west-2b = {   # Availbility Zone
							Public = [
								"10.54.64.0/24","10.54.65.0/24","10.54.66.0/24","10.54.67.0/24" 
								]
							Private = [
								"10.54.68.0/24","10.54.69.0/24","10.54.70.0/24","10.54.71.0/24","10.54.72.0/24"
								]
							Network = [
								"10.54.124.0/24","10.54.125.0/24","10.54.126.0/24","10.54.127.0/24"
								]
						},
						us-west-2c = {  # Availbility Zone
							Public = [
								"10.54.128.0/24","10.54.129.0/24","10.54.130.0/24","10.54.131.0/24"
								]
							Private = [
								"10.54.132.0/24","10.54.133.0/24","10.54.134.0/24","10.54.135.0/24"
								]
							Network = [
								"10.54.189.0/24","10.54.190.0/24","10.54.191.0/24"
								]
						}

					}
				},
                SandBoxVPC = {   # VPC
					vpc_cidr_block = "10.56.0.0/16"
					vpc_environment_type = "Dev"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-west-2a = {   # Availbility Zone
							Public = [
								"10.56.0.0/24","10.56.1.0/24","10.56.2.0/24","10.56.3.0/24"
								]
							Private = [
								"10.56.4.0/24","10.56.5.0/24",  "10.56.6.0/24","10.56.7.0/24", "10.56.8.0/24"
								]
							Network = [
								"10.56.60.0/24","10.56.61.0/24","10.56.62.0/24","10.56.63.0/24"
								]
						},
						us-west-2b = {   # Availbility Zone
							Public = [
								"10.56.64.0/24","10.56.65.0/24","10.56.66.0/24","10.56.67.0/24" 
								]
							Private = [
								"10.56.68.0/24","10.56.69.0/24","10.56.70.0/24","10.56.71.0/24","10.56.72.0/24"
								]
							Network = [
								"10.56.124.0/24","10.56.125.0/24","10.56.126.0/24","10.56.127.0/24"
								]
						},
						us-west-2c = {  # Availbility Zone
							Public = [
								"10.56.128.0/24","10.56.129.0/24","10.56.130.0/24","10.56.131.0/24"
								]
							Private = [
								"10.56.132.0/24","10.56.133.0/24","10.56.134.0/24","10.56.135.0/24"
								]
							Network = [
								"10.56.189.0/24","10.56.190.0/24","10.56.191.0/24"
								]
						}

					}
				}
			}

		},
	
        us-east-2 = { # Region
		    
			vpc_info = {
				ProdVPC = {   # VPC
					vpc_cidr_block = "10.61.0.0/16"
					vpc_environment_type = "Prod"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false*/
	
					az_info = {

						us-east-2a = { # Availbility Zone
							Public = [
								"10.61.0.0/24","10.61.1.0/24","10.61.2.0/24","10.61.3.0/24"
								]
							Private = [
								"10.61.4.0/24","10.61.5.0/24",  "10.61.6.0/24","10.61.7.0/24", "10.61.8.0/24"
								]
							Network = [
								"10.61.60.0/24","10.61.61.0/24","10.61.62.0/24","10.61.63.0/24"
								]
						},
						us-east-2b = {  # Availbility Zone
							Public = [
								"10.61.64.0/24","10.61.65.0/24","10.61.66.0/24","10.61.67.0/24" 
								]
							Private = [
								"10.61.68.0/24","10.61.69.0/24","10.61.70.0/24","10.61.71.0/24","10.61.72.0/24"
								]
							Network = [
								"10.61.124.0/24","10.61.125.0/24","10.61.126.0/24","10.61.127.0/24"
								]
						},
						us-east-2c = {  # Availbility Zone
							Public = [
								"10.61.128.0/24","10.61.129.0/24","10.61.130.0/24","10.61.131.0/24"
								]
							Private = [
								"10.61.132.0/24","10.61.133.0/24","10.61.134.0/24","10.61.135.0/24"
								]
							Network = [
								"10.61.189.0/24","10.61.190.0/24","10.61.191.0/24"
								]
						}

					}
				},
				TestVPC = {  # VPC
					vpc_cidr_block = "10.62.0.0/16"
					vpc_environment_type ="Test"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false	
					vpc_enable_classiclink = false */
					
					az_info = {

						us-east-2a = {  # Availbility Zone
							Public = [
								"10.62.0.0/24","10.62.1.0/24","10.62.2.0/24","10.62.3.0/24"
								]
							Private = [
								"10.62.4.0/24","10.62.5.0/24",  "10.62.6.0/24","10.62.7.0/24", "10.62.8.0/24"
								]
							Network = [
								"10.62.60.0/24","10.62.61.0/24","10.62.62.0/24","10.62.63.0/24"
								]
						},
						us-east-2b = {  # Availbility Zone
							Public = [
								"10.62.64.0/24","10.62.65.0/24","10.62.66.0/24","10.62.67.0/24" 
								]
							Private = [
								"10.62.68.0/24","10.62.69.0/24","10.62.70.0/24","10.62.71.0/24","10.62.72.0/24"
								]
							Network = [
								"10.62.124.0/24","10.62.125.0/24","10.62.126.0/24","10.62.127.0/24"
								]
						},
						us-east-2c = {  # Availbility Zone
							Public = [
								"10.62.128.0/24","10.62.129.0/24","10.62.130.0/24","10.62.131.0/24"
								]
							Private = [
								"10.62.132.0/24","10.62.133.0/24","10.62.134.0/24","10.62.135.0/24"
								]
							Network = [
								"10.62.189.0/24","10.62.190.0/24","10.62.191.0/24"
								]
						}

					}
				},
				DevVPC = {   # VPC
					vpc_cidr_block = "10.63.0.0/16"
					vpc_environment_type = "Dev"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-east-2a = {   # Availbility Zone
							Public = [
								"10.63.0.0/24","10.63.1.0/24","10.63.2.0/24","10.63.3.0/24"
								]
							Private = [
								"10.63.4.0/24","10.63.5.0/24",  "10.63.6.0/24","10.63.7.0/24", "10.63.8.0/24"
								]
							Network = [
								"10.63.60.0/24","10.63.61.0/24","10.63.62.0/24","10.63.63.0/24"
								]
						},
						us-east-2b = {   # Availbility Zone
							Public = [
								"10.63.64.0/24","10.63.65.0/24","10.63.66.0/24","10.63.67.0/24" 
								]
							Private = [
								"10.63.68.0/24","10.63.69.0/24","10.63.70.0/24","10.63.71.0/24","10.63.72.0/24"
								]
							Network = [
								"10.63.124.0/24","10.63.125.0/24","10.63.126.0/24","10.63.127.0/24"
								]
						},
						us-east-2c = {  # Availbility Zone
							Public = [
								"10.63.128.0/24","10.63.129.0/24","10.63.130.0/24","10.63.131.0/24"
								]
							Private = [
								"10.63.132.0/24","10.63.133.0/24","10.63.134.0/24","10.63.135.0/24"
								]
							Network = [
								"10.63.189.0/24","10.63.190.0/24","10.63.191.0/24"
								]
						}

					}
				},

                SharedServiceVPC = {   # VPC
					vpc_cidr_block = "10.64.0.0/16"
					vpc_environment_type = "Prod"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-east-2a = {   # Availbility Zone
							Public = [
								"10.64.0.0/24","10.64.1.0/24","10.64.2.0/24","10.64.3.0/24"
								]
							Private = [
								"10.64.4.0/24","10.64.5.0/24",  "10.64.6.0/24","10.64.7.0/24", "10.64.8.0/24"
								]
							Network = [
								"10.64.60.0/24","10.64.61.0/24","10.64.62.0/24","10.64.63.0/24"
								]
						},
						us-east-2b = {   # Availbility Zone
							Public = [
								"10.64.64.0/24","10.64.65.0/24","10.64.66.0/24","10.64.67.0/24" 
								]
							Private = [
								"10.64.68.0/24","10.64.69.0/24","10.64.70.0/24","10.64.71.0/24","10.64.72.0/24"
								]
							Network = [
								"10.64.124.0/24","10.64.125.0/24","10.64.126.0/24","10.64.127.0/24"
								]
						},
						us-east-2c = {  # Availbility Zone
							Public = [
								"10.64.128.0/24","10.64.129.0/24","10.64.130.0/24","10.64.131.0/24"
								]
							Private = [
								"10.64.132.0/24","10.64.133.0/24","10.64.134.0/24","10.64.135.0/24"
								]
							Network = [
								"10.64.189.0/24","10.64.190.0/24","10.64.191.0/24"
								]
						}

					}
				},
                SandBoxVPC = {   # VPC
					vpc_cidr_block = "10.66.0.0/16"
					vpc_environment_type = "Dev"
					vpc_enable_dns_support = true
					vpc_enable_dns_hostnames = true
					/*vpc_instance_tenancy = "default"
					vpc_enable_classiclink_dns_support = false
					vpc_assign_generated_ipv6_cidr_block = false
					vpc_enable_classiclink = false */
					
					az_info = {

						us-east-2a = {   # Availbility Zone
							Public = [
								"10.66.0.0/24","10.66.1.0/24","10.66.2.0/24","10.66.3.0/24"
								]
							Private = [
								"10.66.4.0/24","10.66.5.0/24",  "10.66.6.0/24","10.66.7.0/24", "10.66.8.0/24"
								]
							Network = [
								"10.66.60.0/24","10.66.61.0/24","10.66.62.0/24","10.66.63.0/24"
								]
						},
						us-east-2b = {   # Availbility Zone
							Public = [
								"10.66.64.0/24","10.66.65.0/24","10.66.66.0/24","10.66.67.0/24" 
								]
							Private = [
								"10.66.68.0/24","10.66.69.0/24","10.66.70.0/24","10.66.71.0/24","10.66.72.0/24"
								]
							Network = [
								"10.66.124.0/24","10.66.125.0/24","10.66.126.0/24","10.66.127.0/24"
								]
						},
						us-east-2c = {  # Availbility Zone
							Public = [
								"10.66.128.0/24","10.66.129.0/24","10.66.130.0/24","10.66.131.0/24"
								]
							Private = [
								"10.66.132.0/24","10.66.133.0/24","10.66.134.0/24","10.66.135.0/24"
								]
							Network = [
								"10.66.189.0/24","10.66.190.0/24","10.66.191.0/24"
								]
						}

					}
				}
			}

		}

	}



    /*
    us-west-2a = {
        Public = [
            "10.51.0.0/24","10.51.1.0/24","10.51.2.0/24","10.51.3.0/24"
            ]
        Private = [
            "10.51.4.0/24","10.51.5.0/24",  "10.51.6.0/24","10.51.7.0/24", "10.51.8.0/24", "10.51.9.0/24",  "10.51.10.0/24","10.51.11.0/24",
            "10.51.12.0/24","10.51.13.0/24","10.51.14.0/24","10.51.15.0/24","10.51.16.0/24","10.51.17.0/24","10.51.18.0/24",
            "10.51.19.0/24","10.51.20.0/24","10.51.21.0/24","10.51.22.0/24","10.51.23.0/24","10.51.24.0/24","10.51.25.0/24",
            "10.51.26.0/24","10.51.27.0/24","10.51.28.0/24","10.51.29.0/24","10.51.30.0/24","10.51.31.0/24","10.51.32.0/24",
            "10.51.33.0/24","10.51.34.0/24","10.51.35.0/24","10.51.36.0/24","10.51.37.0/24","10.51.38.0/24","10.51.39.0/24",
            "10.51.40.0/24","10.51.41.0/24","10.51.42.0/24","10.51.43.0/24","10.51.44.0/24","10.51.45.0/24","10.51.46.0/24",
            "10.51.47.0/24","10.51.48.0/24","10.51.49.0/24","10.51.50.0/24","10.51.51.0/24","10.51.52.0/24","10.51.53.0/24",
            "10.51.54.0/24","10.51.55.0/24","10.51.56.0/24","10.51.57.0/24","10.51.58.0/24","10.51.59.0/24"]
        Network = [
            "10.51.60.0/24","10.51.61.0/24","10.51.62.0/24","10.51.63.0/24"
            ]
        },
      us-west-2b = {
        Public = [
             "10.51.64.0/24","10.51.65.0/24","10.51.66.0/24","10.51.67.0/24" 
             ]
        Private = [
              "10.51.68.0/24","10.51.69.0/24","10.51.70.0/24","10.51.71.0/24","10.51.72.0/24","10.51.73.0/24","10.51.74.0/24",
              "10.51.75.0/24","10.51.76.0/24","10.51.77.0/24","10.51.78.0/24","10.51.79.0/24","10.51.80.0/24","10.51.81.0/24",
              "10.51.82.0/24","10.51.83.0/24","10.51.84.0/24","10.51.85.0/24","10.51.86.0/24","10.51.87.0/24","10.51.88.0/24",
              "10.51.89.0/24","10.51.90.0/24","10.51.91.0/24","10.51.92.0/24","10.51.93.0/24","10.51.94.0/24","10.51.95.0/24",
              "10.51.96.0/24","10.51.97.0/24","10.51.98.0/24","10.51.99.0/24","10.51.100.0/24","10.51.101.0/24","10.51.102.0/24",
              "10.51.103.0/24","10.51.104.0/24","10.51.105.0/24","10.51.106.0/24","10.51.107.0/24","10.51.108.0/24","10.51.109.0/24",
              "10.51.110.0/24","10.51.111.0/24","10.51.112.0/24","10.51.113.0/24","10.51.114.0/24","10.51.115.0/24","10.51.116.0/24",
              "10.51.117.0/24","10.51.118.0/24","10.51.119.0/24","10.51.120.0/24","10.51.121.0/24","10.51.122.0/24","10.51.123.0/24"
              ]
        Network = [
              "10.51.124.0/24","10.51.125.0/24","10.51.126.0/24","10.51.127.0/24"
              ]
        },
        us-west-2c = {
          Public = [
              "10.51.128.0/24","10.51.129.0/24","10.51.130.0/24","10.51.131.0/24"
              ]
          Private = [
              "10.51.132.0/24","10.51.133.0/24","10.51.134.0/24","10.51.135.0/24","10.51.136.0/24","10.51.137.0/24","10.51.138.0/24",
              "10.51.139.0/24","10.51.140.0/24","10.51.141.0/24","10.51.142.0/24","10.51.143.0/24","10.51.144.0/24","10.51.145.0/24",
              "10.51.146.0/24","10.51.147.0/24","10.51.148.0/24","10.51.149.0/24","10.51.150.0/24","10.51.151.0/24","10.51.152.0/24",
              "10.51.153.0/24","10.51.154.0/24","10.51.155.0/24","10.51.156.0/24","10.51.157.0/24","10.51.158.0/24","10.51.159.0/24",
              "10.51.160.0/24","10.51.161.0/24","10.51.162.0/24","10.51.163.0/24","10.51.164.0/24","10.51.165.0/24","10.51.166.0/24",
              "10.51.167.0/24","10.51.168.0/24","10.51.169.0/24","10.51.170.0/24","10.51.171.0/24","10.51.172.0/24","10.51.173.0/24",
              "10.51.174.0/24","10.51.175.0/24","10.51.176.0/24","10.51.177.0/24","10.51.178.0/24","10.51.179.0/24","10.51.180.0/24",
              "10.51.181.0/24","10.51.182.0/24","10.51.183.0/24","10.51.184.0/24","10.51.185.0/24","10.51.186.0/24","10.51.187.0/24",
              "10.51.188.0/24"
              ]
          Network = [
              "10.51.189.0/24","10.51.190.0/24","10.51.191.0/24"
              ]
        }
    }
    
    */


    





























#Create Subnets
resource "aws_subnet" SubNet {

  for_each = toset(lookup( lookup( var.ProdSubnetMap, "us-west-2a" ), "NetworkSubnets"))

  vpc_id = aws_vpc.ProdVPC.id
  cidr_block =  each.key
  
  availability_zone = "us-west-2a"
  map_public_ip_on_launch = false

  depends_on = [aws_vpc.ProdVPC]

  tags = {

      Name = join( " ", ["Subnet", "${each.key}"])
      "for each key"  =  each.key
      "for each value" = each.value
      CIDR_block = each.key
      "Environment Type"= "Prod"
      SubnetType  = "NetworkSubnets"
      "Availability Zone" = "us-west-2a"
  } 


output "mysubnet" {
  value = lookup( lookup( var.ProdSubnetMap, "us-west-2a" ), "NetworkSubnets")
}

output  "myazs" {
  value = lookup( var.AZMap, "us-west-2" )
}



output "Foreachsubnets" {
  value = {
    for_each = toset(lookup( lookup( var.ProdSubnetMap, "us-west-2a" ), "NetworkSubnets"))
      value = each.value
    }
}



variable "ProdSubnetMap" {
  description = "Prod Subnet map for us-west-2"
  // outer map key: AZ Name
  // outer map value: inner map
  // inner map key: subnet type
  // inner map value : subnet list

  type = map(map(list(string)))
  default = {
      us-west-2a = {
        PublicSubnets = [
            "10.51.0.0/24","10.51.1.0/24","10.51.2.0/24","10.51.3.0/24"
            ]
        PrivateSubnets = [
            "10.51.4.0/24","10.51.5.0/24",  "10.51.6.0/24","10.51.7.0/24", "10.51.8.0/24", "10.51.9.0/24",  "10.51.10.0/24","10.51.11.0/24",
            "10.51.12.0/24","10.51.13.0/24","10.51.14.0/24","10.51.15.0/24","10.51.16.0/24","10.51.17.0/24","10.51.18.0/24",
            "10.51.19.0/24","10.51.20.0/24","10.51.21.0/24","10.51.22.0/24","10.51.23.0/24","10.51.24.0/24","10.51.25.0/24",
            "10.51.26.0/24","10.51.27.0/24","10.51.28.0/24","10.51.29.0/24","10.51.30.0/24","10.51.31.0/24","10.51.32.0/24",
            "10.51.33.0/24","10.51.34.0/24","10.51.35.0/24","10.51.36.0/24","10.51.37.0/24","10.51.38.0/24","10.51.39.0/24",
            "10.51.40.0/24","10.51.41.0/24","10.51.42.0/24","10.51.43.0/24","10.51.44.0/24","10.51.45.0/24","10.51.46.0/24",
            "10.51.47.0/24","10.51.48.0/24","10.51.49.0/24","10.51.50.0/24","10.51.51.0/24","10.51.52.0/24","10.51.53.0/24",
            "10.51.54.0/24","10.51.55.0/24","10.51.56.0/24","10.51.57.0/24","10.51.58.0/24","10.51.59.0/24"]
        NetworkSubnets = [
            "10.51.60.0/24","10.51.61.0/24","10.51.62.0/24","10.51.63.0/24"
            ]
        },
      us-west-2b = {
        PublicSubnets = [
             "10.51.64.0/24","10.51.65.0/24","10.51.66.0/24","10.51.67.0/24" 
             ]
        PrivateSubnets = [
              "10.51.68.0/24","10.51.69.0/24","10.51.70.0/24","10.51.71.0/24","10.51.72.0/24","10.51.73.0/24","10.51.74.0/24",
              "10.51.75.0/24","10.51.76.0/24","10.51.77.0/24","10.51.78.0/24","10.51.79.0/24","10.51.80.0/24","10.51.81.0/24",
              "10.51.82.0/24","10.51.83.0/24","10.51.84.0/24","10.51.85.0/24","10.51.86.0/24","10.51.87.0/24","10.51.88.0/24",
              "10.51.89.0/24","10.51.90.0/24","10.51.91.0/24","10.51.92.0/24","10.51.93.0/24","10.51.94.0/24","10.51.95.0/24",
              "10.51.96.0/24","10.51.97.0/24","10.51.98.0/24","10.51.99.0/24","10.51.100.0/24","10.51.101.0/24","10.51.102.0/24",
              "10.51.103.0/24","10.51.104.0/24","10.51.105.0/24","10.51.106.0/24","10.51.107.0/24","10.51.108.0/24","10.51.109.0/24",
              "10.51.110.0/24","10.51.111.0/24","10.51.112.0/24","10.51.113.0/24","10.51.114.0/24","10.51.115.0/24","10.51.116.0/24",
              "10.51.117.0/24","10.51.118.0/24","10.51.119.0/24","10.51.120.0/24","10.51.121.0/24","10.51.122.0/24","10.51.123.0/24"
              ]
        NetworkSubnets = [
              "10.51.124.0/24","10.51.125.0/24","10.51.126.0/24","10.51.127.0/24"
              ]
        },
        us-west-2c = {
          PublicSubnets = [
              "10.51.128.0/24","10.51.129.0/24","10.51.130.0/24","10.51.131.0/24"
              ]
          PrivateSubnets = [
              "10.51.132.0/24","10.51.133.0/24","10.51.134.0/24","10.51.135.0/24","10.51.136.0/24","10.51.137.0/24","10.51.138.0/24",
              "10.51.139.0/24","10.51.140.0/24","10.51.141.0/24","10.51.142.0/24","10.51.143.0/24","10.51.144.0/24","10.51.145.0/24",
              "10.51.146.0/24","10.51.147.0/24","10.51.148.0/24","10.51.149.0/24","10.51.150.0/24","10.51.151.0/24","10.51.152.0/24",
              "10.51.153.0/24","10.51.154.0/24","10.51.155.0/24","10.51.156.0/24","10.51.157.0/24","10.51.158.0/24","10.51.159.0/24",
              "10.51.160.0/24","10.51.161.0/24","10.51.162.0/24","10.51.163.0/24","10.51.164.0/24","10.51.165.0/24","10.51.166.0/24",
              "10.51.167.0/24","10.51.168.0/24","10.51.169.0/24","10.51.170.0/24","10.51.171.0/24","10.51.172.0/24","10.51.173.0/24",
              "10.51.174.0/24","10.51.175.0/24","10.51.176.0/24","10.51.177.0/24","10.51.178.0/24","10.51.179.0/24","10.51.180.0/24",
              "10.51.181.0/24","10.51.182.0/24","10.51.183.0/24","10.51.184.0/24","10.51.185.0/24","10.51.186.0/24","10.51.187.0/24",
              "10.51.188.0/24"
              ]
          NetworkSubnets = [
              "10.51.189.0/24","10.51.190.0/24","10.51.191.0/24"
              ]
        }
    }
















From main  ..

variable


variable "vpc_region" {
  type = string
  description = "AWS Region"
  validation {
	condition = ( var.vpc_region == "us-east-2" || var.vpc_region == "us-west-2" || var.vpc_region == "us-west-1" || var.vpc_region == "us-east-1")
	error_message = "Region can be us-east-2 or us-west-2."
    }
}




					//az_info = map(   					#AZs
					//	map( 							#Subnet types
					//		list(string)  				#subnets
					//	)
					//)  	
                    az_info = map(   					#AZs
						map( 							#Subnet
							object({
                                sn_class_type = string
                                sn_uuid = string
                            })
						)
					) 



tfvars


				/*	az_info = {

						us-east-2a = { # Availbility Zone
							Public = [
								"10.57.0.0/24","10.57.1.0/24"
								]
							Private = [
								"10.58.4.0/24","10.58.5.0/24"
								]
						}

					}*/

                    az_info = {
						us-east-2a = { # Availbility Zone
							"10.57.0.0/24" = {
                                sn_class_type = "Public"
                                sn_uuid = "62204fcf-392f-4125-8c05-c2cbdfe050bb"    
                            },
                            "10.58.4.0/24" = {
                                sn_class_type = "Private"
                                sn_uuid = "3887f8cc-11f7-438a-a5f0-b6d60a8da807"
                            }
						}

					}








# Get the Subnets info
locals {
  // outer map key: vpc Name
  // inner map key: vpc object
  // outer map key: AZ Name
  // inner map key: Az map
  // outer map value: inner map
  // inner map key: subnet type
  // inner map value : subnet list

  vpc_network_subnets =  flatten([
    for region_key, region_obj in var.RegionMap : [   
      for vpc_key, vpc_obj in region_obj.vpc_info : [
        for az_key, az in vpc_obj.az_info : [
          for subnet_key, subnet_value in subnets : [
             {
              vpc_region_name = region_key
              vpc_name = vpc_key
              az_name = az_key
              vpc_cidr_block = vpc_obj.vpc_cidr_block 
              vpc_enable_dns_support = vpc_obj.vpc_enable_dns_support
              vpc_enable_dns_hostnames = vpc_obj.vpc_enable_dns_hostnames
              vpc_environment_type = vpc_obj.vpc_environment_type
              subnet_type = subnet_type
              cidr_block = subnet_value
              }
          ]   
        ]
      ]
    ]
  ])
}
# Create Subnets
resource "aws_subnet" "create_subnets" {
    
   depends_on = [aws_vpc_ipv4_cidr_block_association.secondary_cidr]   //local.vpc_depends_on] 

  for_each = {
    for subnet in local.vpc_network_subnets :  "${subnet.vpc_name}.${subnet.az_name}.${subnet.subnet_type}.${subnet.cidr_block}" => subnet if subnet.vpc_region_name == var.vpc_region
    }
  vpc_id = lookup(aws_vpc.this, "${each.value.vpc_name}").id 
  cidr_block =  each.value.cidr_block
  availability_zone = each.value.az_name
  map_public_ip_on_launch = false

  tags = {
      Name = join( " ", ["${each.key}"])
      CIDR_block = each.value.cidr_block
      "Environment Type" =  each.value.vpc_environment_type
      SubnetType  = each.value.subnet_type
      "Availability Zone" = each.value.az_name
      "VPC" = each.value.vpc_name
      "Date_created" = formatdate("DD MMM YYYY hh:mm ZZZ", timestamp())
  } 
}








# Get the Subnets info
locals {
  // outer map key: vpc Name
  // inner map key: vpc object
  // outer map key: AZ Name
  // inner map key: Az map
  // outer map value: inner map
  // inner map key: subnet type
  // inner map value : subnet list

  vpc_network_subnets =  flatten([
    for region_key, region_obj in var.RegionMap : [
      for vpc_key, vpc_obj in region_obj.vpc_info : [
        for az_key, az in vpc_obj.az_info : [
          for subnet_type, subnets in az : [
            for subnet_key, subnet_obj in subnets : {
              vpc_region_name = region_key
              vpc_name = vpc_key
              az_name = az_key
              vpc_cidr_block = vpc_obj.vpc_cidr_block 
              vpc_enable_dns_support = vpc_obj.vpc_enable_dns_support
              vpc_enable_dns_hostnames = vpc_obj.vpc_enable_dns_hostnames
              vpc_environment_type = vpc_obj.vpc_environment_type
              subnet_type = subnet_obj.sn_class_type
              cidr_block = subnet_key
              }
          ]   
        ]
      ]
    ]
  ])
}



